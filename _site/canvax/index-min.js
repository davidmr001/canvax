define("canvax/animation/AnimationFrame",[],function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}),window.FlashCanvasOptions={swfPath:"http://g.tbcdn.cn/thx/canvax/1.0.0/canvax/library/flashCanvas/"},define("canvax/core/Base",[document.createElement("canvas").getContext?"":"canvax/library/flashCanvas/flashcanvas","canvax/animation/AnimationFrame",window._?"":"canvax/library/underscore"],function(a){var b=function(a,b){return document[a]?function(b,c,d){if(b.length)for(var e=0;e<b.length;e++)arguments.callee(b[e],c,d);else b[a](c,d,!1)}:function(a,c,d){if(a.length)for(var e=0;e<a.length;e++)arguments.callee(a[e],c,d);else a[b]("on"+c,function(){return d.call(a,window.event)})}},c={mainFrameRate:60,now:0,getEl:function(a){return _.isString(a)?document.getElementById(a):1==a.nodeType?a:a.length?a[0]:null},getOffset:function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,h=1;if(d.getBoundingClientRect){var i=d.getBoundingClientRect();h=(i.right-i.left)/d.clientWidth}h>1&&(f=0,g=0);var j=b.top/h+(window.pageYOffset||e&&e.scrollTop/h||d.scrollTop/h)-f,k=b.left/h+(window.pageXOffset||e&&e.scrollLeft/h||d.scrollLeft/h)-g;return{top:j,left:k}},addEvent:b("addEventListener","attachEvent"),removeEvent:b("removeEventListener","detachEvent"),_pixelCtx:null,__emptyFunc:function(){},_devicePixelRatio:window.devicePixelRatio||1,_createCanvas:function(a,b,c){var d=document.createElement("canvas");return d.style.position="absolute",d.style.width=b+"px",d.style.height=c+"px",d.style.left=0,d.style.top=0,d.setAttribute("width",b*this._devicePixelRatio),d.setAttribute("height",c*this._devicePixelRatio),d.setAttribute("id",a),d},canvasSupport:function(){return!!document.createElement("canvas").getContext},createObject:function(a,b){var d,e=Object.create;return e?d=e(a):(c.__emptyFunc.prototype=a,d=new c.__emptyFunc),d.constructor=b,d},setContextStyle:function(a,b){for(p in b)"textBaseline"!=p&&p in a&&(b[p]||_.isNumber(b[p]))&&("globalAlpha"==p?a[p]*=b[p]:a[p]=b[p])},creatClass:function(a,b,d){if(!b||!a)return a;var e,f=b.prototype;return e=c.createObject(f,a),a.prototype=_.extend(e,a.prototype),a.superclass=c.createObject(f,b),d&&_.extend(e,d),a},initElement:function(b){a&&a.initElement&&a.initElement(b)},checkOpt:function(a){return a?a&&!a.context?(a.context={},a):a:{context:{}}},_UID:0,getUID:function(){return this._UID++},createId:function(a){var b=a.charCodeAt(a.length-1);return b>=48&&57>=b&&(a+="_"),a+c.getUID()},copy:function(a,b,c){if(_.isEmpty(b))return a;for(var d in b)(!c||a.hasOwnProperty(d)||void 0!==a[d])&&(a[d]=b[d]);return a},getCssOrderArr:function(a){var b,c,d,e;return"number"==typeof a?b=c=d=e=a:a instanceof Array?1===a.length?b=c=d=e=a[0]:2===a.length?(b=d=a[0],c=e=a[1]):3===a.length?(b=a[0],c=e=a[1],d=a[2]):(b=a[0],c=a[1],d=a[2],e=a[3]):b=c=d=e=0,[b,c,d,e]},setDeepExtend:function(){(function(){var a,b,c,d,e,f,g=[].slice;c=function(a){var b,d;return!_.isObject(a)||_.isFunction(a)?a:_.isDate(a)?new Date(a.getTime()):_.isRegExp(a)?new RegExp(a.source,a.toString().replace(/.*\//,"")):(d=_.isArray(a||_.isArguments(a)),b=function(a,b,e){return d?a.push(c(b)):a[e]=c(b),a},_.reduce(a,b,d?[]:{}))},f=function(a){return!(null!=a&&void 0!=a&&a.prototype!=={}.prototype&&a.prototype!==Object.prototype||!_.isObject(a)||_.isArray(a)||_.isFunction(a)||_.isDate(a)||_.isRegExp(a)||_.isArguments(a))},b=function(a){return _.filter(_.keys(a),function(b){return f(a[b])})},a=function(a){return _.filter(_.keys(a),function(b){return _.isArray(a[b])})},e=function(c,d,f){if(!d)return c;var g,h,i,j,k,l,m,n,o,p;if(null==f&&(f=20),0>=f)return _.extend(c,d);for(l=_.intersection(b(c),b(d)),h=function(a){return d[a]=e(c[a],d[a],f-1)},m=0,o=l.length;o>m;m++)k=l[m],h(k);for(j=_.intersection(a(c),a(d)),g=function(a){return d[a]},n=0,p=j.length;p>n;n++)i=j[n],g(i);return _.extend(c,d)},d=function(){var a,b,d,f;if(d=2<=arguments.length?g.call(arguments,0,f=arguments.length-1):(f=0,[]),b=arguments[f++],_.isNumber(b)||(d.push(b),b=20),d.length<=1)return d[0];if(0>=b)return _.extend.apply(this,d);for(a=d.shift();d.length>0;)a=e(a,c(d.shift()),b);return a},_.mixin({deepClone:c,isBasicObject:f,basicObjects:b,arrays:a,deepExtend:d})}).call(window)}};return c.setDeepExtend(),c}),define("canvax/core/PropertyFactory",[],function(a){function b(a,c,e){function g(a,f){(!d[a]||d[a]&&"$"!==a.charAt(0))&&(c[a]=f);var g=typeof f;if("function"===g)d[a]||l.push(a);else{if(-1!==_.indexOf(i,a)||"$"===a.charAt(0)&&!e[a])return l.push(a);var m=function(d){var e,f=m.value,i=f;if(!arguments.length)return!f||"object"!==g||f instanceof Array||f.$model||(f.$parent=j,f=b(f,f),m.value=f),f;var k=typeof d;if(!h&&f!==d){!d||"object"!==k||d instanceof Array?f=d:(f=d.$model?d:b(d,d),e=f.$model),m.value=f,c[a]=e?e:f,e||j.$fire&&j.$fire(a,f,i),g!=k&&(g=k);var l=j;if(!j.$watch)for(;l.$parent;)l=l.$parent;l.$watch&&l.$watch.call(l,a,f,i)}};m.value=f,k[a]={set:m,get:m,enumerable:!0}}}var h=!0,i=a.$skipArray,j={},k={},l=_.keys(d);c=c||{},e=e||{},i=_.isArray(i)?i.concat(l):l;for(var m in a)g(m,a[m]);return j=f(j,k,l),_.forEach(l,function(b){a[b]&&("function"==typeof a[b]?j[b]=function(){a[b].apply(this,arguments)}:j[b]=a[b])}),j.$model=c,j.$accessor=k,j.hasOwnProperty=function(a){return a in j.$model},h=!1,j}function c(a,b,c){var d=a[b]&&a[b].set;return 3!==arguments.length?d():void d(c)}var d={$skipArray:0,$watch:1,$fire:2,$model:3,$accessor:4,$owner:5,$parent:7},e=Object.defineProperty;try{e({},"_",{value:"x"});var f=Object.defineProperties}catch(g){"__defineGetter__"in Object&&(e=function(a,b,c){return"value"in c&&(a[b]=c.value),"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),a},f=function(a,b){for(var c in b)b.hasOwnProperty(c)&&e(a,c,b[c]);return a})}return!f&&window.VBArray&&(window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),f=function(a,b,d){a=d.slice(0),a.push("hasOwnProperty");var e="VBClass"+setTimeout("1"),f={},g=[];g.push("Class "+e,"	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function"),_.forEach(a,function(a){f[a]!==!0&&(f[a]=!0,g.push("	Public ["+a+"]"))});for(var h in b)f[h]=!0,g.push("	Public Property Let ["+h+"](val)",'		Call [__proxy__]([__data__], "'+h+'", val)',"	End Property","	Public Property Set ["+h+"](val)",'		Call [__proxy__]([__data__], "'+h+'", val)',"	End Property","	Public Property Get ["+h+"]","	On Error Resume Next","		Set["+h+'] = [__proxy__]([__data__],"'+h+'")',"	If Err.Number <> 0 Then","		["+h+'] = [__proxy__]([__data__],"'+h+'")',"	End If","	On Error Goto 0","	End Property");return g.push("End Class"),g.push("Function "+e+"Factory(a, b)","	Dim o","	Set o = (New "+e+")(a, b)","	Set "+e+"Factory = o","End Function"),window.parseVB(g.join("\r\n")),window[e+"Factory"](b,c)}),window.PropertyFactory=b,b}),define("canvax/display/Point",[],function(){var a=function(a,b){if(1!=arguments.length||"object"!=typeof arguments[0])a||(a=0),b||(b=0),this.x=1*a,this.y=1*b;else{var c=arguments[0];if("x"in c&&"y"in c)this.x=1*c.x,this.y=1*c.y;else{var d=0;for(var e in c){if(0!=d){this.y=1*c[e];break}this.x=1*c[e],d++}}}};return a}),define("canvax/event/CanvaxEvent",["canvax/core/Base"],function(a,b){var c=function(a){this.target=null,this.currentTarget=null,this.params=null,this.type=a.type,this.points=null,this._stopPropagation=!1};return c.prototype={stopPropagation:function(){this._stopPropagation=!0}},c.pageX=function(a){return a.pageX?a.pageX:a.clientX?a.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):null},c.pageY=function(a){return a.pageY?a.pageY:a.clientY?a.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):null},c}),define("canvax/event/EventManager",[],function(){var a=function(){this._eventMap={}};return a.prototype={_addEventListener:function(a,b){if("function"!=typeof b)return!1;var c=!0,d=this;return _.each(a.split(" "),function(a){var e=d._eventMap[a];return e?-1==_.indexOf(e,b)?(e.push(b),d._eventEnabled=!0,!0):void(c=!1):(e=d._eventMap[a]=[],e.push(b),d._eventEnabled=!0,!0)}),c},_removeEventListener:function(a,b){if(1==arguments.length)return this.removeEventListenerByType(a);var c=this._eventMap[a];if(!c)return!1;for(var d=0;d<c.length;d++){var e=c[d];if(e===b)return c.splice(d,1),0==c.length&&(delete this._eventMap[a],_.isEmpty(this._eventMap)&&(this._eventEnabled=!1)),!0}return!1},_removeEventListenerByType:function(a){var b=this._eventMap[a];return b?!1:(delete this._eventMap[a],_.isEmpty(this._eventMap)&&(this._eventEnabled=!1),!0)},_removeAllEventListeners:function(){this._eventMap={},this._eventEnabled=!1},_dispatchEvent:function(a){var b=this._eventMap[a.type];if(b){a.target||(a.target=this),b=b.slice();for(var c=0;c<b.length;c++){var d=b[c];"function"==typeof d&&d.call(this,a)}}return a._stopPropagation||this.parent&&(a.currentTarget=this.parent,this.parent._dispatchEvent(a)),!0},_hasEventListener:function(a){var b=this._eventMap[a];return null!=b&&b.length>0}},a}),define("canvax/event/EventDispatcher",["canvax/core/Base","canvax/event/EventManager"],function(a,b){var c=function(){arguments.callee.superclass.constructor.call(this,name)};return a.creatClass(c,b,{on:function(a,b){return this._addEventListener(a,b),this},addEventListener:function(a,b){return this._addEventListener(a,b),this},un:function(a,b){return this._removeEventListener(a,b),this},removeEventListener:function(a,b){return this._removeEventListener(a,b),this},removeEventListenerByType:function(a){return this._removeEventListenerByType(a),this},removeAllEventListeners:function(){return this._removeAllEventListeners(),this},fire:function(a,b){var c=b||{},d=this;_.isObject(a)&&a.type&&(c=_.extend(c,a),a=a.type);var e=c?c.currentTarget:null;return _.each(a.split(" "),function(a){var b=null;c?(b=c.type,c.type=a):c={type:a},c.currentTarget=d,d.dispatchEvent(c),b&&(c.type=b)}),c.currentTarget=e,this},dispatchEvent:function(a){if(this instanceof DisplayObjectContainer&&a.point){var b=this.getObjectsUnderPoint(a.point,1)[0];return void(b&&b.dispatchEvent(a))}{if(!this.context||"mouseover"!=a.type){if(this._dispatchEvent(a),this.context&&"mouseout"==a.type&&this._hoverClass){var c=this.getStage().parent;this._hoverClass=!1,c._hoverStage.removeChildById(this.id),this._globalAlpha&&(this.context.globalAlpha=this._globalAlpha,delete this._globalAlpha)}return this}var d=this._heartBeatNum,e=this.context.globalAlpha;if(this._dispatchEvent(a),d!=this._heartBeatNum&&(this._hoverClass=!0,this.hoverClone)){var c=this.getStage().parent,f=this.clone(!0);f._transform=this.getConcatenatedMatrix(),c._hoverStage.addChildAt(f,0),this._globalAlpha=e,this.context.globalAlpha=0}}},hasEvent:function(a){return this._hasEventListener(a)},hasEventListener:function(a){return this._hasEventListener(a)},hover:function(a,b){return this.on("mouseover",a),this.on("mouseout",b),this},once:function(a,b){return this.on(a,function(){b.apply(this,arguments),this.un(a,arguments.callee)}),this}}),c}),define("canvax/event/EventHandler",["canvax/core/Base","ontouchstart"in window?"canvax/event/handler/touch":"canvax/event/handler/mouse","canvax/display/Point","canvax/event/CanvaxEvent"],function(a,b,c,d){var e=function(a){this.canvax=a,this.curPoints=[new c(0,0)],this.curPointsTarget=[],this._touching=!1,this._draging=!1,this._cursor="default"};return a.creatClass(e,b,{__dispatchEventInChilds:function(a,b){if(!(b||"length"in b))return!1;var c=this,e=!1;return _.each(b,function(b,f){if(b){e=!0;var g=new d(a);g.target=g.currentTarget=b||this,g.stagePoint=c.curPoints[f],g.point=g.target.globalToLocal(g.stagePoint),b.dispatchEvent(g)}}),e},_clone2hoverStage:function(a,b){var c=this,d=c.canvax,e=d._hoverStage.getChildById(a.id);return e||(e=a.clone(!0),e._transform=a.getConcatenatedMatrix(),d._hoverStage.addChildAt(e,0)),e.context.visible=!0,e._dragPoint=a.globalToLocal(c.curPoints[b]),e},_dragHander:function(a,b,d){var e=this,f=e.canvax,g=f._hoverStage.getChildById(b.id),h=new c(e.curPoints[d].x-g._dragPoint.x,e.curPoints[d].y-g._dragPoint.y);g.context.x=h.x,g.context.y=h.y,b.drag&&b.drag(a);var i=h;"stage"!=b.type&&b.parent&&"stage"!=b.parent.type&&(i=b.parent.globalToLocal(h)),b._notWatch=!0,b.context.x=i.x,b.context.y=i.y,b._notWatch=!1},_dragEnd:function(a,b,c){var d=this,e=d.canvax,f=e._hoverStage.getChildById(b.id);b.context.visible=!0,f.destroy()}}),e}),define("canvax/geom/Math",[],function(){function a(a,b){return a=(b?a*g:a).toFixed(4),"undefined"==typeof f.sin[a]&&(f.sin[a]=Math.sin(a)),f.sin[a]}function b(a,b){return a=(b?a*g:a).toFixed(4),"undefined"==typeof f.cos[a]&&(f.cos[a]=Math.cos(a)),f.cos[a]}function c(a){return a*g}function d(a){return a/g}function e(a){var b=(360+a%360)%360;return 0==b&&0!==a&&(b=360),b}var f={sin:{},cos:{}},g=Math.PI/180;return{PI:Math.PI,sin:a,cos:b,degreeToRadian:c,radianToDegree:d,degreeTo360:e}}),define("canvax/geom/HitTestPoint",["canvax/core/Base","canvax/geom/Math"],function(a,b){function c(b,c){var g=c.x,h=c.y;if("bitmap"==b.type)return!0;if(!b||!b.type)return!1;var i=b.type,j=d(i,b,g,h);if("undefined"!=typeof j)return j;if("beziercurve"!=i&&b.buildPath&&a._pixelCtx.isPointInPath)return e(b,a._pixelCtx,g,h);if(a._pixelCtx.getImageData)return f(b,g,h);switch(i){case"droplet":return!0;case"ellipse":return!0;default:return!1}}function d(a,b,c,d){switch(a){case"line":return i(b.context,c,d);case"brokenLine":return j(b,c,d);case"text":return!0;case"rect":return!0;case"circle":return l(b,c,d);case"ellipse":return n(b,c,d);case"sector":return m(b,c,d);case"path":return p(b,c,d);case"polygon":case"isogon":return o(b,c,d);case"image":return!0}}function e(a,b,c,d){var b=a.context;return b.beginPath(),a.buildPath(b,b),b.closePath(),b.isPointInPath(c,d)}function f(b,c,d){var e=b.context,f=a._pixelCtx;f.save(),f.beginPath(),a.setContextStyle(f,e.$model),f.transform.apply(f,b.getConcatenatedMatrix().toArray()),f.clearRect(b._rect.x-10,b._rect.y-10,b._rect.width+20,b._rect.height+20),b.draw(f,e),f.globalAlpha=1,b.drawEnd(f),f.closePath(),f.restore();var h=b.getConcatenatedMatrix();if(h){var i=h.clone(),j=[c,d];i.mulVector(j,[c,d,1]),c=j[0],d=j[1]}return g(f,c,d)}function g(a,b,c,d){var e;"undefined"!=typeof d?(d=Math.floor((d||1)/2),e=a.getImageData(b-d,c-d,d+d,d+d).data):e=a.getImageData(b,c,1,1).data;for(var f=e.length;f--;)if(0!==e[f])return!0;return!1}function h(a,b,d){return!c(a,b,d)}function i(a,b,c){var d=a.xStart,e=a.yStart,f=a.xEnd,g=a.yEnd,h=a.lineWidth,i=0,j=d;if(d===f)return Math.abs(b-d)<=h/2;i=(e-g)/(d-f),j=(d*g-f*e)/(d-f);var k=(i*b-c+j)*(i*b-c+j)/(i*i+1);return h/2*h/2>=k}function j(a,b,c){for(var d,e=a.context,f=e.pointList,g=!1,h=0,j=f.length-1;j>h&&(d={xStart:f[h][0],yStart:f[h][1],xEnd:f[h+1][0],yEnd:f[h+1][1],lineWidth:e.lineWidth},!k({x:Math.min(d.xStart,d.xEnd)-d.lineWidth,y:Math.min(d.yStart,d.yEnd)-d.lineWidth,width:Math.abs(d.xStart-d.xEnd)+d.lineWidth,height:Math.abs(d.yStart-d.yEnd)+d.lineWidth},b,c)||!(g=i(d,b,c)));h++);return g}function k(a,b,c){return b>=a.x&&b<=a.x+a.width&&c>=a.y&&c<=a.y+a.height?!0:!1}function l(a,b,c,d){var e=a.context;return!d&&(d=e.r),d*d>b*b+c*c}function m(a,c,d){var e=a.context;if(!l(a,c,d)||e.r0>0&&l(a,c,d,e.r0))return!1;var f=b.degreeTo360(e.startAngle),g=b.degreeTo360(e.endAngle),h=b.degreeTo360(Math.atan2(d,c)/Math.PI*180%360),i=!0;(f>g&&!e.clockwise||g>f&&e.clockwise)&&(i=!1);var j=[Math.min(f,g),Math.max(f,g)],k=h>j[0]&&h<j[1];return k&&i||!k&&!i}function n(a,b,c){var d,e=a.context,f={x:0,y:0},g=e.hr,h=e.vr,i={x:b,y:c};return i.x-=f.x,i.y-=f.y,i.x*=i.x,i.y*=i.y,g*=g,h*=h,d=h*i.x+g*i.y-g*h,0>d}function o(a,b,c){var d,e,f,g=a.context?a.context:a,h=g.pointList,i=h.length,j=!1,k=!0;for(d=0;i>d;++d)if(h[d][0]==b&&h[d][1]==c){k=!1,j=!0;break}if(k)for(k=!1,j=!1,d=0,e=i-1;i>d;e=d++)if(h[d][1]<c&&c<h[e][1]||h[e][1]<c&&c<h[d][1]){if(b<=h[d][0]||b<=h[e][0])if(f=(c-h[d][1])*(h[e][0]-h[d][0])/(h[e][1]-h[d][1])+h[d][0],f>b)j=!j;else if(b==f){j=!0;break}}else if(c==h[d][1]){if(b<h[d][0]){h[d][1]>h[e][1]?--c:++c;break}}else if(h[d][1]==h[e][1]&&c==h[d][1]&&(h[d][0]<b&&b<h[e][0]||h[e][0]<b&&b<h[d][0])){j=!0;break}return j}function p(a,b,c){for(var d=a.context,e=d.pointList,f=!1,g=0,h=e.length;h>g&&!(f=o({pointList:e[g]},b,c));g++);return f}var q={};return q={isInside:c,isOutside:h}}),define("canvax/geom/Matrix",["canvax/core/Base"],function(a){var b=function(a,b,c,d,e,f){this.a=void 0!=a?a:1,this.b=void 0!=b?b:0,this.c=void 0!=c?c:0,this.d=void 0!=d?d:1,this.tx=void 0!=e?e:0,this.ty=void 0!=f?f:0};return a.creatClass(b,function(){},{concat:function(a){var b=this.a,c=this.c,d=this.tx;return this.a=b*a.a+this.b*a.c,this.b=b*a.b+this.b*a.d,this.c=c*a.a+this.d*a.c,this.d=c*a.b+this.d*a.d,this.tx=d*a.a+this.ty*a.c+a.tx,this.ty=d*a.b+this.ty*a.d+a.ty,this},concatTransform:function(a,c,d,e,f){var g=1,h=0;if(f%360){var i=f*Math.PI/180;g=Math.cos(i),h=Math.sin(i)}return this.concat(new b(g*d,h*d,-h*e,g*e,a,c)),this},rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;if(a>0)this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b;else{var g=Math.sin(Math.abs(a)),h=Math.cos(Math.abs(a));this.a=d*h+this.b*g,this.b=-d*g+this.b*h,this.c=e*h+this.d*g,this.d=-e*g+h*this.d,this.tx=h*f+g*this.ty,this.ty=h*this.ty-g*f}return this},scale:function(a,b){return this.a*=a,this.d*=b,this.tx*=a,this.ty*=b,this},translate:function(a,b){return this.tx+=a,this.ty+=b,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},clone:function(){return new b(this.a,this.b,this.c,this.d,this.tx,this.ty)},toArray:function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},mulVector:function(a,b){var c=this.a,d=this.c,e=this.tx,f=this.b,g=this.d,h=this.ty;return a[0]=b[0]*c+b[1]*d+e,a[1]=b[0]*f+b[1]*g+h,a}}),b}),define("canvax/geom/Vector",[],function(){function a(a,b){var c=0,d=0;if(1==arguments.length&&_.isObject(a)){var e=arguments[0];_.isArray(e)?(c=e[0],d=e[1]):e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&(c=e.x,d=e.y)}this._axes=[c,d]}return a.prototype={distance:function(a){var b=this._axes[0]-a._axes[0],c=this._axes[1]-a._axes[1];return Math.sqrt(b*b+c*c)}},a}),define("canvax/geom/SmoothSpline",["canvax/geom/Vector"],function(a){function b(a,b,c,d,e,f,g){var h=.5*(c-a),i=.5*(d-b);return(2*(b-c)+h+i)*g+(-3*(b-c)-2*h-i)*f+h*e+b}return function(c){var d=c.points,e=c.isLoop,f=c.smoothFilter,g=d.length;if(1==g)return d;for(var h=[],i=0,j=new a(d[0]),k=null,l=1;g>l;l++)k=new a(d[l]),i+=j.distance(k),j=k;j=null,k=null;var m=i/6;m=g>m?g:m;for(var l=0;m>l;l++){var n,o,p,q=l/(m-1)*(e?g:g-1),r=Math.floor(q),s=q-r,t=d[r%g];e?(n=d[(r-1+g)%g],o=d[(r+1)%g],p=d[(r+2)%g]):(n=d[0===r?r:r-1],o=d[r>g-2?g-1:r+1],p=d[r>g-3?g-1:r+2]);var u=s*s,v=s*u,w=[b(n[0],t[0],o[0],p[0],s,u,v),b(n[1],t[1],o[1],p[1],s,u,v)];_.isFunction(f)&&f(w),h.push(w)}return h}}),define("canvax/display/DisplayObject",["canvax/event/EventDispatcher","canvax/geom/Matrix","canvax/display/Point","canvax/core/Base","canvax/geom/HitTestPoint",window.PropertyFactory?"":"canvax/core/PropertyFactory"],function(a,b,c,d,e,f){f||(f=window.PropertyFactory);var g=function(a){arguments.callee.superclass.constructor.apply(this,arguments);var b=this;a=d.checkOpt(a),b.id=a.id||null,b._transform=null,b._heartBeatNum=0,b.stage=null,b.parent=null,b._eventEnabled=!1,b.dragEnabled="dragEnabled"in a?a.dragEnabled:!1,b.xyToInt="xyToInt"in a?a.xyToInt:!0,b._createContext(a);var c=d.createId(b.type);null==b.id&&(b.id=c),b.init.apply(b,arguments),this._updateTransform()};return d.creatClass(g,a,{init:function(){},_createContext:function(a){var b=this;b.context=null;var c=d.copy({width:0,height:0,x:0,y:0,scaleX:1,scaleY:1,scaleOrigin:{x:0,y:0},rotation:0,rotateOrigin:{x:0,y:0},visible:!0,cursor:"default",fillStyle:null,lineCap:null,lineJoin:null,lineWidth:null,miterLimit:null,shadowBlur:null,shadowColor:null,shadowOffsetX:null,shadowOffsetY:null,strokeStyle:null,globalAlpha:1,font:null,textAlign:"left",textBaseline:"top",arcScaleX_:null,arcScaleY_:null,lineScale_:null,globalCompositeOperation:null},a.context,!0);b._context&&(c=_.extend(c,b._context)),b._notWatch=!1,c.$owner=b,c.$watch=function(a,b,c){var d=["x","y","scaleX","scaleY","rotation","scaleOrigin","rotateOrigin, lineWidth"];_.indexOf(d,a)>=0&&this.$owner._updateTransform(),this.$owner._notWatch||(this.$owner.$watch&&this.$owner.$watch(a,b,c),this.$owner.heartBeat({convertType:"context",shape:this.$owner,name:a,value:b,preValue:c}))},b.context=f(c)},clone:function(a){var b={id:this.id,context:this.context.$model};this.img&&(b.img=this.img);var c=new this.constructor(b);return a||(c.id=d.createId(c.type)),c},heartBeat:function(a){var b=this.getStage();b&&(this._heartBeatNum++,b.heartBeat&&b.heartBeat(a))},getCurrentWidth:function(){return Math.abs(this.context.width*this.context.scaleX)},getCurrentHeight:function(){return Math.abs(this.context.height*this.context.scaleY)},getStage:function(){if(this.stage)return this.stage;var a=this;if("stage"!=a.type){for(;a.parent&&(a=a.parent,"stage"!=a.type););if("stage"!==a.type)return!1}return this.stage=a,a},localToGlobal:function(a,d){!a&&(a=new c(0,0));var e=this.getConcatenatedMatrix(d);if(null==e)return c(0,0);var f=new b(1,0,0,1,a.x,a.y);return f.concat(e),new c(f.tx,f.ty)},globalToLocal:function(a,d){if(!a&&(a=new c(0,0)),"stage"==this.type)return a;var e=this.getConcatenatedMatrix(d);if(null==e)return new c(0,0);e.invert();var f=new b(1,0,0,1,a.x,a.y);return f.concat(e),new c(f.tx,f.ty)},localToTarget:function(a,b){var c=localToGlobal(a);return b.globalToLocal(c)},getConcatenatedMatrix:function(a){for(var c=new b,d=this;null!=d;d=d.parent)if(c.concat(d._transform),!d.parent||a&&d.parent&&d.parent==a||d.parent&&"stage"==d.parent.type)return c;return c},setEventEnable:function(a){return _.isBoolean(a)?(this._eventEnabled=a,!0):!1},getIndex:function(){return this.parent?_.indexOf(this.parent.children,this):void 0},toBack:function(a){if(this.parent){var b=this.getIndex(),c=0;if(_.isNumber(a)){if(0==a)return;c=b-a}var d=this.parent.children.splice(b,1)[0];0>c&&(c=0),this.parent.addChildAt(d,c)}},toFront:function(a){if(this.parent){var b=this.getIndex(),c=this.parent.children.length,d=c;if(_.isNumber(a)){if(0==a)return;d=b+a+1}var e=this.parent.children.splice(b,1)[0];d>c&&(d=c),this.parent.addChildAt(e,d-1)}},_transformHander:function(a){var b=this._transform;b||(b=this._updateTransform()),a.transform.apply(a,b.toArray())},_updateTransform:function(){var a=new b;a.identity();var d=this.context;if(1!==d.scaleX||1!==d.scaleY){var e=new c(d.scaleOrigin);(e.x||e.y)&&a.translate(-e.x,-e.y),a.scale(d.scaleX,d.scaleY),(e.x||e.y)&&a.translate(e.x,e.y)}var f=d.rotation;if(f){var e=new c(d.rotateOrigin);(e.x||e.y)&&a.translate(-e.x,-e.y),a.rotate(f%360*Math.PI/180),(e.x||e.y)&&a.translate(e.x,e.y)}var g,h;if(this.xyToInt){var g=Math.round(d.x),h=Math.round(d.y);parseInt(d.lineWidth,10)%2==1&&d.strokeStyle&&(g+=.5,h+=.5)}else g=d.x,h=d.y;return(0!=g||0!=h)&&a.translate(g,h),this._transform=a,a},getRect:function(a){return{x:0,y:0,width:a.width,height:a.height}},getChildInPoint:function(a){var b;"stage"!=this.type&&this.parent&&"stage"!=this.parent.type&&(a=this.parent.globalToLocal(a));var c=a.x,d=a.y;if(this._notWatch=!0,this._transform){var f=this._transform.clone().invert(),g=[c,d];f.mulVector(g,[c,d]),c=g[0],d=g[1]}var h=this._rect=this.getRect(this.context);return h?(!this.context.width&&h.width&&(this.context.width=h.width),!this.context.height&&h.height&&(this.context.height=h.height),h.width&&h.height?(b=c>=h.x&&c<=h.x+h.width&&d>=h.y&&d<=h.y+h.height?e.isInside(this,{x:c,y:d}):!1,this._notWatch=!1,b):!1):!1},_render:function(a){!this.context.visible||this.context.globalAlpha<=0||(a.save(),this._transformHander(a),"text"!=this.type&&d.setContextStyle(a,this.context.$model),this.render(a),a.restore())},render:function(a){},remove:function(){this.parent&&this.parent.removeChild(this)},destroy:function(){this.remove(),this.context=null,delete this.context}}),g}),define("canvax/display/DisplayObjectContainer",["canvax/core/Base","canvax/display/DisplayObject","canvax/display/Point"],function(a,b,c){return DisplayObjectContainer=function(a){var b=this;b.children=[],b.mouseChildren=[],arguments.callee.superclass.constructor.apply(this,arguments),b._eventEnabled=!0},a.creatClass(DisplayObjectContainer,b,{addChild:function(a){return a?-1!=this.getChildIndex(a)?(a.parent=this,a):(a.parent&&a.parent.removeChild(a),this.children.push(a),a.parent=this,this.heartBeat&&this.heartBeat({convertType:"children",target:a,src:this}),this._afterAddChild&&this._afterAddChild(a),a):void 0},addChildAt:function(a,b){return-1!=this.getChildIndex(a)?(a.parent=this,a):(a.parent&&a.parent.removeChild(a),this.children.splice(b,0,a),a.parent=this,this.heartBeat&&this.heartBeat({convertType:"children",target:a,src:this}),this._afterAddChild&&this._afterAddChild(a,b),a)},removeChild:function(a){return this.removeChildAt(_.indexOf(this.children,a))},removeChildAt:function(a){if(0>a||a>this.children.length-1)return!1;var b=this.children[a];return null!=b&&(b.parent=null),this.children.splice(a,1),this.heartBeat&&this.heartBeat({convertType:"children",target:b,src:this}),this._afterDelChild&&this._afterDelChild(b,a),b},removeChildById:function(a){for(var b=0,c=this.children.length;c>b;b++)if(this.children[b].id==a)return this.removeChildAt(b);return!1},removeAllChildren:function(){for(;this.children.length>0;)this.removeChildAt(0)},destroy:function(){this.parent&&this.parent.removeChild(this),_.each(this.children,function(a){a.destroy()})},getChildById:function(a,b){if(b)return null;for(var c=0,d=this.children.length;d>c;c++)if(this.children[c].id==a)return this.children[c];return null},getChildAt:function(a){return 0>a||a>this.children.length-1?null:this.children[a]},getChildIndex:function(a){return _.indexOf(this.children,a)},setChildIndex:function(a,b){if(a.parent==this){var c=_.indexOf(this.children,a);b!=c&&(this.children.splice(c,1),this.children.splice(b,0,a))}},contains:function(a){return-1!=this.getChildIndex(a)},getNumChildren:function(){return this.children.length},getObjectsUnderPoint:function(a,b){for(var c=[],d=this.children.length-1;d>=0;d--){var e=this.children[d];if(null!=e&&(e._eventEnabled||e.dragEnabled)&&e.context.visible)if(e instanceof DisplayObjectContainer){if(e.mouseChildren&&e.getNumChildren()>0){var f=e.getObjectsUnderPoint(a);f.length>0&&(c=c.concat(f))}}else if(e.getChildInPoint(a)&&(c.push(e),void 0!=b&&!isNaN(b)&&c.length==b))return c}return c},render:function(a){for(var b=0,c=this.children.length;c>b;b++)this.children[b]._render(a)}}),DisplayObjectContainer}),define("canvax/display/Shape",["canvax/display/DisplayObject","canvax/core/Base"],function(a,b){var c=function(a){var b=this;b._hoverable=!1,b._clickable=!1,b._hoverClass=!1,b.hoverClone=!0,b.pointChkPriority=!0,b._dragDuplicate=null,b.type=b.type||"shape",a.draw&&(b.draw=a.draw),b.initCompProperty(a),arguments.callee.superclass.constructor.apply(this,arguments),b._rect=null};return b.creatClass(c,a,{init:function(){},initCompProperty:function(a){for(var b in a)"id"!=b&&"context"!=b&&(this[b]=a[b])},draw:function(){},drawEnd:function(a){if(!this._hasFillAndStroke){var b=this.context;"stroke"!=this._drawTypeOnly&&"path"!=this.type&&a.closePath(),b.strokeStyle&&b.lineWidth&&a.stroke(),b.fillStyle&&"stroke"!=this._drawTypeOnly&&a.fill()}},render:function(){var a=this.getStage().context2D;"shape"==this.context.type?this.draw.apply(this):this.draw&&(a.beginPath(),this.draw(a,this.context),this.drawEnd(a))},dashedLineTo:function(a,b,c,d,e,f){f="undefined"==typeof f?3:f,f=Math.max(f,this.context.lineWidth);for(var g=d-b,h=e-c,i=Math.floor(Math.sqrt(g*g+h*h)/f),j=0;i>j;++j){var k=parseInt(b+g/i*j),l=parseInt(c+h/i*j);a[j%2===0?"moveTo":"lineTo"](k,l),j==i-1&&j%2===0&&a.lineTo(d,e)}},getRectFormPointList:function(a){for(var b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MAX_VALUE,e=Number.MIN_VALUE,f=a.pointList,g=0,h=f.length;h>g;g++)f[g][0]<b&&(b=f[g][0]),f[g][0]>c&&(c=f[g][0]),f[g][1]<d&&(d=f[g][1]),f[g][1]>e&&(e=f[g][1]);var i;return i=a.strokeStyle||a.fillStyle?a.lineWidth||1:0,{x:Math.round(b-i/2),y:Math.round(d-i/2),width:c-b+i,height:e-d+i}}}),c}),define("canvax/display/Sprite",["canvax/display/DisplayObjectContainer","canvax/core/Base"],function(a,b){var c=function(){var a=this;a.type="sprite",arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{init:function(){}}),c}),define("canvax/display/Stage",["canvax/display/DisplayObjectContainer","canvax/core/Base"],function(a,b){var c=function(){var a=this;a.type="stage",a.context2D=null,a.stageRending=!1,a._isReady=!1,arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{init:function(){},initStage:function(a,c,d){var e=this;e.context2D=a,e.context.width=c,e.context.height=d,e.context.scaleX=b._devicePixelRatio,e.context.scaleY=b._devicePixelRatio,e._isReady=!0},render:function(a){this.stageRending=!0,this.clear(),c.superclass.render.call(this,a),this.stageRending=!1},heartBeat:function(a){this._isReady&&(a||(a={}),a.stage=this,this.parent&&this.parent.heartBeat(a))},clear:function(a,c,d,e){arguments.length>=4?this.context2D.clearRect(a,c,d,e):this.context2D.clearRect(0,0,this.context2D.canvas.width*b._devicePixelRatio,this.context2D.canvas.height*b._devicePixelRatio)}}),c}),define("canvax/display/Text",["canvax/display/DisplayObject","canvax/core/Base"],function(a,b){var c=function(a,c){var d=this;d.type="text",d._reNewline=/\r?\n/,d.fontProperts=["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"],c=b.checkOpt(c);var e=c.context;d._context={fontSize:e.fontSize||13,fontWeight:e.fontWeight||"normal",fontFamily:e.fontFamily||"微软雅黑",textDecoration:e.textDecoration,fillStyle:e.fontColor||c.context.fillStyle||"blank",lineHeight:e.lineHeight||1.3,backgroundColor:e.backgroundColor,textBackgroundColor:e.textBackgroundColor},d._context.font=d._getFontDeclaration(),d.text=a.toString(),arguments.callee.superclass.constructor.apply(this,[c])};return b.creatClass(c,a,{$watch:function(a,b,c){_.indexOf(this.fontProperts,a)>=0&&(this._context[a]=b,this._notWatch=!1,this.context.font=this._getFontDeclaration(),this.context.width=this.getTextWidth(),this.context.height=this.getTextHeight())},init:function(a,b){var c=this.context;c.width=this.getTextWidth(),c.height=this.getTextHeight()},render:function(a){for(p in this.context.$model)p in a&&"textBaseline"!=p&&this.context.$model[p]&&(a[p]=this.context.$model[p]);this._renderText(a,this._getTextLines())},resetText:function(a){this.text=a.toString(),this.heartBeat()},getTextWidth:function(){var a=0;return b._pixelCtx.save(),b._pixelCtx.font=this.context.font,a=this._getTextWidth(b._pixelCtx,this._getTextLines()),b._pixelCtx.restore(),a},getTextHeight:function(){return this._getTextHeight(b._pixelCtx,this._getTextLines())},_getTextLines:function(){return this.text.split(this._reNewline)},_renderText:function(a,b){a.save(),this._renderTextFill(a,b),this._renderTextStroke(a,b),a.restore()},_getFontDeclaration:function(){var a=this,b=[];
return _.each(this.fontProperts,function(c){var d=a._context[c];"fontSize"==c&&(d=parseFloat(d)+"px"),d&&b.push(d)}),b.join(" ")},_renderTextFill:function(a,b){if(this.context.fillStyle){this._boundaries=[];for(var c=0,d=0,e=b.length;e>d;d++){var f=this._getHeightOfLine(a,d,b);c+=f,this._renderTextLine("fillText",a,b[d],0,this._getTopOffset()+c,d)}}},_renderTextStroke:function(a,b){if(this.context.strokeStyle&&this.context.lineWidth||this._skipFillStrokeCheck){var c=0;a.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),supportsLineDash&&a.setLineDash(this.strokeDashArray)),a.beginPath();for(var d=0,e=b.length;e>d;d++){var f=this._getHeightOfLine(a,d,b);c+=f,this._renderTextLine("strokeText",a,b[d],0,this._getTopOffset()+c,d)}a.closePath(),a.restore()}},_renderTextLine:function(a,b,c,d,e,f){if(e-=this.context.fontSize/4,"justify"!==this.context.textAlign)return void this._renderChars(a,b,c,d,e,f);var g=b.measureText(c).width,h=this.context.width;if(h>g)for(var i=c.split(/\s+/),j=b.measureText(c.replace(/\s+/g,"")).width,k=h-j,l=i.length-1,m=k/l,n=0,o=0,p=i.length;p>o;o++)this._renderChars(a,b,i[o],d+n,e,f),n+=b.measureText(i[o]).width+m;else this._renderChars(a,b,c,d,e,f)},_renderChars:function(a,b,c,d,e){b[a](c,0,e)},_getHeightOfLine:function(){return this.context.fontSize*this.context.lineHeight},_getTextWidth:function(a,b){for(var c=a.measureText(b[0]||"|").width,d=1,e=b.length;e>d;d++){var f=a.measureText(b[d]).width;f>c&&(c=f)}return c},_getTextHeight:function(a,b){return this.context.fontSize*b.length*this.context.lineHeight},_getTopOffset:function(){var a=0;switch(this.context.textBaseline){case"top":a=0;break;case"middle":a=-this.context.height/2;break;case"bottom":a=-this.context.height}return a},getRect:function(){var a=this.context,b=0,c=0;return"center"==a.textAlign&&(b=-a.width/2),"right"==a.textAlign&&(b=-a.width),"middle"==a.textBaseline&&(c=-a.height/2),"bottom"==a.textBaseline&&(c=-a.height),{x:b,y:c,width:a.width,height:a.height}}}),c}),define("canvax/shape/BrokenLine",["canvax/display/Shape","canvax/core/Base","canvax/geom/SmoothSpline"],function(a,b,c){var d=function(a){var c=this;c.type="brokenline",c._drawTypeOnly="stroke",a=b.checkOpt(a),c._initPointList(a.context),c._context={lineType:a.context.lineType||null,smooth:a.context.smooth||!1,pointList:a.context.pointList||[],smoothFilter:a.context.smoothFilter||null},c.originPointList=null,arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(d,a,{$watch:function(a,b,c){"pointList"==a&&this._initPointList(this.context,b,c)},_initPointList:function(a,b,d){var e=a;if(e.smooth){var f={points:e.pointList};_.isFunction(e.smoothFilter)&&(f.smoothFilter=e.smoothFilter),this._notWatch=!0;var g=c(f);b&&(g[g.length-1][0]=b[b.length-1][0]),e.pointList=g,this._notWatch=!1}this.originPointList=e.pointList},draw:function(a,b){var c=b.pointList;if(!(c.length<2))if(!b.lineType||"solid"==b.lineType||b.smooth){a.moveTo(c[0][0],c[0][1]);for(var d=1,e=c.length;e>d;d++)a.lineTo(c[d][0],c[d][1])}else if("dashed"==b.lineType||"dotted"==b.lineType){a.moveTo(c[0][0],c[0][1]);for(var d=1,e=c.length;e>d;d++){var f=c[d-1][0],g=c[d][0],h=c[d-1][1],i=c[d][1];this.dashedLineTo(a,f,h,g,i,5)}}},getRect:function(a){var a=a?a:this.context;return this.getRectFormPointList(a)}}),d}),define("canvax/shape/Circle",["canvax/display/Shape","canvax/core/Base"],function(a,b){var c=function(a){var c=this;c.type="circle",a=b.checkOpt(a),"xyToInt"in a||(a.xyToInt=!1),c._context={r:a.context.r||0},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{draw:function(a,b){b&&a.arc(0,0,b.r,0,2*Math.PI,!0)},getRect:function(a){var b,a=a?a:this.context;return b=a.fillStyle||a.strokeStyle?a.lineWidth||1:0,{x:Math.round(0-a.r-b/2),y:Math.round(0-a.r-b/2),width:2*a.r+b,height:2*a.r+b}}}),c}),define("canvax/shape/Line",["canvax/display/Shape","canvax/core/Base"],function(a,b){var c=function(a){var c=this;this.type="line",this.drawTypeOnly="stroke",a=b.checkOpt(a),c._context={lineType:a.context.lineType||null,xStart:a.context.xStart||0,yStart:a.context.yStart||0,xEnd:a.context.xEnd||0,yEnd:a.context.yEnd||0,dashLength:a.context.dashLength},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{draw:function(a,b){b.lineType&&"solid"!=b.lineType?("dashed"==b.lineType||"dotted"==b.lineType)&&this.dashedLineTo(a,b.xStart,b.yStart,b.xEnd,b.yEnd,b.dashLength):(a.moveTo(parseInt(b.xStart),parseInt(b.yStart)),a.lineTo(parseInt(b.xEnd),parseInt(b.yEnd)))},getRect:function(a){var b=a.lineWidth||1,a=a?a:this.context;return{x:Math.min(a.xStart,a.xEnd)-b,y:Math.min(a.yStart,a.yEnd)-b,width:Math.abs(a.xStart-a.xEnd)+b,height:Math.abs(a.yStart-a.yEnd)+b}}}),c}),define("canvax/shape/Path",["canvax/display/Shape","canvax/core/Base"],function(a,b){var c=function(a){var c=this;c.type="path",a=b.checkOpt(a),"drawTypeOnly"in a&&(c.drawTypeOnly=a.drawTypeOnly),c._context={pointList:[],path:a.context.path||""},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{_parsePathData:function(a){if(!a)return[];var b=a,c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];b=b.replace(/  /g," "),b=b.replace(/ /g,","),b=b.replace(/(\d)-/g,"$1,-"),b=b.replace(/,,/g,",");var d;for(d=0;d<c.length;d++)b=b.replace(new RegExp(c[d],"g"),"|"+c[d]);var e=b.split("|"),f=[],g=0,h=0;for(d=1;d<e.length;d++){var i=e[d],j=i.charAt(0);i=i.slice(1),i=i.replace(new RegExp("e,-","g"),"e-");var k=i.split(",");k.length>0&&""===k[0]&&k.shift();for(var l=0;l<k.length;l++)k[l]=parseFloat(k[l]);for(;k.length>0&&!isNaN(k[0]);){var m,n,o,p,q,r,s,t,u=null,v=[],w=g,x=h;switch(j){case"l":g+=k.shift(),h+=k.shift(),u="L",v.push(g,h);break;case"L":g=k.shift(),h=k.shift(),v.push(g,h);break;case"m":g+=k.shift(),h+=k.shift(),u="M",v.push(g,h),j="l";break;case"M":g=k.shift(),h=k.shift(),u="M",v.push(g,h),j="L";break;case"h":g+=k.shift(),u="L",v.push(g,h);break;case"H":g=k.shift(),u="L",v.push(g,h);break;case"v":h+=k.shift(),u="L",v.push(g,h);break;case"V":h=k.shift(),u="L",v.push(g,h);break;case"C":v.push(k.shift(),k.shift(),k.shift(),k.shift()),g=k.shift(),h=k.shift(),v.push(g,h);break;case"c":v.push(g+k.shift(),h+k.shift(),g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),u="C",v.push(g,h);break;case"S":m=g,n=h,o=f[f.length-1],"C"===o.command&&(m=g+(g-o.points[2]),n=h+(h-o.points[3])),v.push(m,n,k.shift(),k.shift()),g=k.shift(),h=k.shift(),u="C",v.push(g,h);break;case"s":m=g,n=h,o=f[f.length-1],"C"===o.command&&(m=g+(g-o.points[2]),n=h+(h-o.points[3])),v.push(m,n,g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),u="C",v.push(g,h);break;case"Q":v.push(k.shift(),k.shift()),g=k.shift(),h=k.shift(),v.push(g,h);break;case"q":v.push(g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),u="Q",v.push(g,h);break;case"T":m=g,n=h,o=f[f.length-1],"Q"===o.command&&(m=g+(g-o.points[0]),n=h+(h-o.points[1])),g=k.shift(),h=k.shift(),u="Q",v.push(m,n,g,h);break;case"t":m=g,n=h,o=f[f.length-1],"Q"===o.command&&(m=g+(g-o.points[0]),n=h+(h-o.points[1])),g+=k.shift(),h+=k.shift(),u="Q",v.push(m,n,g,h);break;case"A":p=k.shift(),q=k.shift(),r=k.shift(),s=k.shift(),t=k.shift(),w=g,x=h,g=k.shift(),h=k.shift(),u="A",v=this._convertPoint(w,x,g,h,s,t,p,q,r);break;case"a":p=k.shift(),q=k.shift(),r=k.shift(),s=k.shift(),t=k.shift(),w=g,x=h,g+=k.shift(),h+=k.shift(),u="A",v=this._convertPoint(w,x,g,h,s,t,p,q,r)}f.push({command:u||j,points:v})}("z"===j||"Z"===j)&&f.push({command:"z",points:[]})}return f},_convertPoint:function(a,b,c,d,e,f,g,h,i){var j=i*(Math.PI/180),k=Math.cos(j)*(a-c)/2+Math.sin(j)*(b-d)/2,l=-1*Math.sin(j)*(a-c)/2+Math.cos(j)*(b-d)/2,m=k*k/(g*g)+l*l/(h*h);m>1&&(g*=Math.sqrt(m),h*=Math.sqrt(m));var n=Math.sqrt((g*g*h*h-g*g*l*l-h*h*k*k)/(g*g*l*l+h*h*k*k));e===f&&(n*=-1),isNaN(n)&&(n=0);var o=n*g*l/h,p=n*-h*k/g,q=(a+c)/2+Math.cos(j)*o-Math.sin(j)*p,r=(b+d)/2+Math.sin(j)*o+Math.cos(j)*p,s=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])},t=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(s(a)*s(b))},u=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(t(a,b))},v=u([1,0],[(k-o)/g,(l-p)/h]),w=[(k-o)/g,(l-p)/h],x=[(-1*k-o)/g,(-1*l-p)/h],y=u(w,x);return t(w,x)<=-1&&(y=Math.PI),t(w,x)>=1&&(y=0),0===f&&y>0&&(y-=2*Math.PI),1===f&&0>y&&(y+=2*Math.PI),[q,r,g,h,v,y,j,f]},draw:function(a,b){for(var c,d=b.path,e=this._parsePathData(d),f=0,g=0,h=b.pointList=[],i=[],j=0,k=e.length;k>j;j++){"M"==e[j].command.toUpperCase()&&(i.length>0&&h.push(i),i=[]),c=e[j].points;for(var l=0,m=c.length;m>l;l+=2)i.push([c[l]+f,c[l+1]+g])}i.length>0&&h.push(i);for(var n,j=0,k=e.length;k>j;j++){n=e[j].command,c=e[j].points;for(var l=0,m=c.length;m>l;l++)l%2===0?c[l]+=f:c[l]+=g;switch(n){case"L":a.lineTo(c[0],c[1]);break;case"M":a.moveTo(c[0],c[1]);break;case"C":a.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":a.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":var o=c[0],p=c[1],q=c[2],r=c[3],s=c[4],t=c[5],u=c[6],v=c[7],w=q>r?q:r,x=q>r?1:q/r,y=q>r?r/q:1;a.translate(o,p),a.rotate(u),a.scale(x,y),a.arc(0,0,w,s,s+t,1-v),a.scale(1/x,1/y),a.rotate(-u),a.translate(-o,-p);break;case"z":a.closePath()}}},getRect:function(a){var b,a=a?a:this.context;b=a.strokeStyle||a.fillStyle?a.lineWidth||1:0;for(var c=Number.MAX_VALUE,d=Number.MIN_VALUE,e=Number.MAX_VALUE,f=Number.MIN_VALUE,g=0,h=0,i=this._parsePathData(a.path),j=0;j<i.length;j++)for(var k=i[j].points,l=0;l<k.length;l++)l%2===0?(k[l]+g<c&&(c=k[l]+g),k[l]+g>d&&(d=k[l]+g)):(k[l]+h<e&&(e=k[l]+h),k[l]+h>f&&(f=k[l]+h));var m;return m=c===Number.MAX_VALUE||d===Number.MIN_VALUE||e===Number.MAX_VALUE||f===Number.MIN_VALUE?{x:0,y:0,width:0,height:0}:{x:Math.round(c-b/2),y:Math.round(e-b/2),width:d-c+b,height:f-e+b}}}),c}),define("canvax/shape/Polygon",["canvax/display/Shape","canvax/core/Base"],function(a,b){var c=function(a){var c=this;c.type="polygon",c._hasFillAndStroke=!0,a=b.checkOpt(a),c._context={lineType:a.context.lineType||null,pointList:a.context.pointList||[]},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{draw:function(a,b){return a.save(),a.beginPath(),this.buildPath(a,b),a.closePath(),(b.strokeStyle||b.lineWidth)&&a.stroke(),b.fillStyle&&(("dashed"==b.lineType||"dotted"==b.lineType)&&(a.beginPath(),this.buildPath(a,{lineType:"solid",lineWidth:b.lineWidth,pointList:b.pointList}),a.closePath()),a.fill()),a.restore(),!0},buildPath:function(a,b){var c=b.pointList,d=c[0],e=c[c.length-1];if(d&&e&&d[0]==e[0]&&d[1]==e[1]&&c.pop(),!(c.length<2))if(b.lineType&&"solid"!=b.lineType){if("dashed"==b.lineType||"dotted"==b.lineType){var f=(b.lineWidth||1)*("dashed"==b.lineType?5:1);a.moveTo(c[0][0],c[0][1]);for(var g=1,h=c.length;h>g;g++)this.dashedLineTo(a,c[g-1][0],c[g-1][1],c[g][0],c[g][1],f);this.dashedLineTo(a,c[c.length-1][0],c[c.length-1][1],c[0][0],c[0][1],f)}}else{a.moveTo(c[0][0],c[0][1]);for(var g=1,h=c.length;h>g;g++)a.lineTo(c[g][0],c[g][1]);a.lineTo(c[0][0],c[0][1])}},getRect:function(a){var a=a?a:this.context;return this.getRectFormPointList(a)}}),c}),define("canvax/shape/Rect",["canvax/display/Shape","canvax/core/Base"],function(a,b){var c=function(a){var c=this;c.type="rect",a=b.checkOpt(a),c._context={width:a.context.width||0,height:a.context.height||0,radius:a.context.radius||[]},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{_buildRadiusPath:function(a,c){var d=0,e=0,f=this.context.width,g=this.context.height,h=b.getCssOrderArr(c.radius);a.moveTo(parseInt(d+h[0]),parseInt(e)),a.lineTo(parseInt(d+f-h[1]),parseInt(e)),0!==h[1]&&a.quadraticCurveTo(d+f,e,d+f,e+h[1]),a.lineTo(parseInt(d+f),parseInt(e+g-h[2])),0!==h[2]&&a.quadraticCurveTo(d+f,e+g,d+f-h[2],e+g),a.lineTo(parseInt(d+h[3]),parseInt(e+g)),0!==h[3]&&a.quadraticCurveTo(d,e+g,d,e+g-h[3]),a.lineTo(parseInt(d),parseInt(e+h[0])),0!==h[0]&&a.quadraticCurveTo(d,e,d+h[0],e)},draw:function(a,b){b.$model.radius.length?this._buildRadiusPath(a,b):(b.fillStyle&&a.fillRect(0,0,this.context.width,this.context.height),b.lineWidth&&a.strokeRect(0,0,this.context.width,this.context.height))},getRect:function(a){var b,a=a?a:this.context;return b=a.fillStyle||a.strokeStyle?a.lineWidth||1:0,{x:Math.round(0-b/2),y:Math.round(0-b/2),width:this.context.width+b,height:this.context.height+b}}}),c}),define("canvax/shape/Sector",["canvax/display/Shape","canvax/geom/Math","canvax/core/Base"],function(a,b,c){var d=function(a){var b=this;b.type="sector",b.regAngle=[],b.isRing=!1,a=c.checkOpt(a),b._context={pointList:[],r0:a.context.r0||0,r:a.context.r||0,startAngle:a.context.startAngle||0,endAngle:a.context.endAngle||0,clockwise:a.context.clockwise||!1},arguments.callee.superclass.constructor.apply(this,arguments)};return c.creatClass(d,a,{draw:function(a,c){var d="undefined"==typeof c.r0?0:c.r0,e=c.r,f=b.degreeTo360(c.startAngle),g=b.degreeTo360(c.endAngle);f==g&&c.startAngle!=c.endAngle&&(this.isRing=!0,f=0,g=360),f=b.degreeToRadian(f),g=b.degreeToRadian(g),.025>g-f&&(f-=.003),a.arc(0,0,e,f,g,this.context.clockwise),0!==d?this.isRing?(a.moveTo(d,0),a.arc(0,0,d,f,g,!this.context.clockwise)):a.arc(0,0,d,g,f,!this.context.clockwise):a.lineTo(0,0)},getRegAngle:function(){this.regIn=!0;var a=this.context,c=b.degreeTo360(a.startAngle),d=b.degreeTo360(a.endAngle);(c>d&&!a.clockwise||d>c&&a.clockwise)&&(this.regIn=!1),this.regAngle=[Math.min(c,d),Math.max(c,d)]},getRect:function(a){var a=a?a:this.context,c="undefined"==typeof a.r0?0:a.r0,d=a.r;this.getRegAngle();var e=b.degreeTo360(a.startAngle),f=b.degreeTo360(a.endAngle),g=[],h={90:[0,d],180:[-d,0],270:[0,-d],360:[d,0]};for(var i in h){var j=parseInt(i)>this.regAngle[0]&&parseInt(i)<this.regAngle[1];(this.isRing||j&&this.regIn||!j&&!this.regIn)&&g.push(h[i])}return this.isRing||(e=b.degreeToRadian(e),f=b.degreeToRadian(f),g.push([b.cos(e)*c,b.sin(e)*c]),g.push([b.cos(e)*d,b.sin(e)*d]),g.push([b.cos(f)*d,b.sin(f)*d]),g.push([b.cos(f)*c,b.sin(f)*c])),a.pointList=g,this.getRectFormPointList(a)}}),d}),define("canvax/index",["canvax/core/Base","canvax/event/EventHandler","canvax/event/EventDispatcher","canvax/event/EventManager","canvax/display/DisplayObjectContainer","canvax/display/Stage","canvax/display/Sprite","canvax/display/Shape","canvax/display/Point","canvax/display/Text"],function(a,b,c,d,e,f,g,h,i,j){var k=function(b){this.type="canvax",this._cid=(new Date).getTime()+"_"+Math.floor(100*Math.random()),this._rootDom=a.getEl(b.el),this.width=parseInt("width"in b||this._rootDom.offsetWidth,10),this.height=parseInt("height"in b||this._rootDom.offsetHeight,10),this.preventDefault=!0,b.preventDefault===!1&&(this.preventDefault=!1);var c="<div id='cc-"+this._cid+"' class='canvax-c' ";c+="style='position:relative;width:"+this.width+"px;height:"+this.height+"px;'>",c+="   <div id='cdc-"+this._cid+"' class='canvax-dom-container' ",c+="   style='position:absolute;width:"+this.width+"px;height:"+this.height+"px;'>",c+="   </div>",c+="</div>",this._rootDom.innerHTML=c,this.el=a.getEl("cc-"+this._cid),this.rootOffset=a.getOffset(this.el),this.lastGetRO=0,this.convertStages={},this._heartBeat=!1,this._speedTime=parseInt(1e3/a.mainFrameRate),this._preRenderTime=0,this._taskList=[],this._hoverStage=null,this._isReady=!1,this.evt=null,arguments.callee.superclass.constructor.apply(this,arguments)};return a.creatClass(k,e,{init:function(){this.context.width=this.width,this.context.height=this.height,this._creatHoverStage(),this.evt=new b(this),this.evt.init(),this._createPixelContext(),this._isReady=!0},resize:function(){this.width=parseInt(this._rootDom.offsetWidth),this.height=parseInt(this._rootDom.offsetHeight),this.el.style.width=this.width+"px",this.el.style.height=this.height+"px",this.rootOffset=a.getOffset(this.el),this._notWatch=!0,this.context.width=this.width,this.context.height=this.height,this._notWatch=!1;var b=this,c=function(c){var d=c.canvas;d.style.width=b.width+"px",d.style.height=b.height+"px",d.setAttribute("width",b.width*a._devicePixelRatio),d.setAttribute("height",b.height*a._devicePixelRatio),c.resize&&c.resize(b.width,b.height)};_.each(this.children,function(a,d){a._notWatch=!0,a.context.width=b.width,a.context.height=b.height,c(a.context2D),a._notWatch=!1});var d=a.getEl("cdc-"+this._cid);d.style.width=this.width+"px",d.style.height=this.height+"px",this.heartBeat()},getDomContainer:function(){return a.getEl("cdc-"+this._cid)},getHoverStage:function(){return this._hoverStage},_creatHoverStage:function(){this._hoverStage=new f({id:"activCanvas"+(new Date).getTime(),context:{width:this.context.width,height:this.context.height}}),this._hoverStage._eventEnabled=!1,this.addChild(this._hoverStage)},_createPixelContext:function(){var b=a.getEl("_pixelCanvas");b||(b=a._createCanvas("_pixelCanvas",this.context.width,this.context.height),document.body.appendChild(b),a.initElement(b),a.canvasSupport()?b.style.display="none":(b.style.zIndex=-1,b.style.position="absolute",b.style.left=-this.context.width+"px",b.style.top=-this.context.height+"px",b.style.visibility="hidden"),a._pixelCtx=b.getContext("2d"))},updateRootOffset:function(){var b=(new Date).getTime();b-this.lastGetRO>1e3&&(this.rootOffset=a.getOffset(this.el),this.lastGetRO=b)},setFrameRate:function(b){a.mainFrameRate!=b&&(a.mainFrameRate=b,this._speedTime=parseInt(1e3/a.mainFrameRate))},getFrameRate:function(){return a.mainFrameRate},__startEnter:function(){var a=this;a.requestAid||(a.requestAid=requestAnimationFrame(_.bind(a.__enterFrame,a)))},__enterFrame:function(){var b=this;if(b.requestAid=null,a.now=(new Date).getTime(),b._heartBeat){if(a.now-b._preRenderTime<b._speedTime)return void b.__startEnter();b.fire("beginRender"),_.each(_.values(b.convertStages),function(a){a.stage._render(a.stage.context2D)}),b._heartBeat=!1,b.convertStages={},b._preRenderTime=(new Date).getTime(),b.fire("afterRender")}if(b._taskList.length>0)for(var c=0,d=b._taskList.length;d>c;c++){var e=b._taskList[c];e.__enterFrame?e.__enterFrame():b.__taskList.splice(c--,1)}b._taskList.length>0&&b.__startEnter()},_afterAddChild:function(b,c){var d;d=b.context2D?b.context2D.canvas:a._createCanvas(b.id,this.context.width,this.context.height);var e=a.getEl("cdc-"+this._cid);1==this.children.length?this.el.insertBefore(d,e):this.children.length>1&&(void 0==c?this.el.insertBefore(d,this._hoverStage.context2D.canvas):c>=this.children.length-1?this.el.insertBefore(d,e):this.el.insertBefore(d,this.children[c].context2D.canvas)),a.initElement(d),b.initStage(d.getContext("2d"),this.context.width,this.context.height)},_afterDelChild:function(a){this.el.removeChild(a.context2D.canvas)},_convertCanvax:function(a){_.each(this.children,function(b){b.context[a.name]=a.value})},heartBeat:function(a){var b=this;if(a){if("context"==a.convertType){var c=a.stage,d=a.shape;a.name,a.value,a.preValue;if(!b._isReady)return;if("canvax"==d.type)b._convertCanvax(a);else if(b.convertStages[c.id]||(b.convertStages[c.id]={stage:c,convertShapes:{}}),d){if(b.convertStages[c.id].convertShapes[d.id])return;b.convertStages[c.id].convertShapes[d.id]={shape:d,convertType:a.convertType}}}if("children"==a.convertType){var e=a.target,c=a.src.getStage();(c||"stage"==e.type)&&(c=c||e,b.convertStages[c.id]||(b.convertStages[c.id]={stage:c,convertShapes:{}}))}if(!a.convertType){var c=a.stage;b.convertStages[c.id]||(b.convertStages[c.id]={stage:c,convertShapes:{}})}}else _.each(b.children,function(a,c){b.convertStages[a.id]={stage:a,convertShapes:{}}});b._heartBeat?b._heartBeat=!0:(b._heartBeat=!0,b.__startEnter())}}),k.Display={Stage:f,Sprite:g,Shape:h,Point:i,Text:j},k.Event={EventDispatcher:c,EventManager:d},k});