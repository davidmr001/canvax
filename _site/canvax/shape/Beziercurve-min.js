define("canvax/shape/Beziercurve",["canvax/display/Shape","canvax/core/Base","canvax/display/Point"],function(a,b,c){var d=function(a){var b=this;b.type="beziercurve",b._drawTypeOnly="stroke",b.length=void 0,a.context||(a.context={}),b._context={xStart:a.context.xStart||0,yStart:a.context.yStart||0,cpX1:a.context.cpX1||0,cpY1:a.context.cpY1||0,cpX2:a.context.cpX2||0,cpY2:a.context.cpY2||0,xEnd:a.context.xEnd||0,yEnd:a.context.yEnd||0},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(d,a,{draw:function(a,b){a.moveTo(b.xStart,b.yStart),"undefined"!=typeof b.cpX2&&"undefined"!=typeof b.cpY2?a.bezierCurveTo(b.cpX1,b.cpY1,b.cpX2,b.cpY2,b.xEnd,b.yEnd):a.quadraticCurveTo(b.cpX1,b.cpY1,b.xEnd,b.yEnd)},getRect:function(a){var a=a?a:this.context,b=Math.min(a.xStart,a.xEnd,a.cpX1),c=Math.min(a.yStart,a.yEnd,a.cpY1),d=Math.max(a.xStart,a.xEnd,a.cpX1),e=Math.max(a.yStart,a.yEnd,a.cpY1),f=a.cpX2,g=a.cpY2;"undefined"!=typeof f&&"undefined"!=typeof g&&(b=Math.min(b,f),c=Math.min(c,g),d=Math.max(d,f),e=Math.max(e,g));var h=a.lineWidth||1;return{x:b-h,y:c-h,width:d-b+h,height:e-c+h}},getLength:function(a){var b=100;void 0==a&&(a=1);var c,d=parseInt(b*a);if(1&d&&d++,0==d)return 0;var e=d>>1,f=0,g=0,h=a/d;for(c=0;e>c;c++)f+=this._getSpeedLength((2*c+1)*h);for(c=1;e>c;c++)g+=this._getSpeedLength(2*c*h);return(this._getSpeedLength(0)+this._getSpeedLength(1)+2*g+4*f)*h/3},getPointByTime:function(a){var b=1-a,d=b*b,e=d*b,f=a*a,g=f*a,h=this.context.$model;return new c(e*h.xStart+3*d*a*h.cpX1+3*b*f*h.cpX2+g*h.xEnd,e*h.yStart+3*d*a*h.cpY1+3*b*f*h.cpY2+g*h.yEnd)},getPointByLen:function(a){if(void 0==this._length&&(this._length=this.getLength()),a>this._length)return{x:this.context.$model.xEnd,y:this.context.$model.yEnd};for(var b,c=a/this._length;;){if(b=c-(this.getLength(c)-a)/this._getSpeedLength(c),Math.abs(c-b)<.01)break;c=b}return this.getPointByTime(b)},getPointsByStep:function(a){a=a||1;for(var b=this.getLength(),c=0,d=[];b>c;)d.push(this.getPointByLen(c)),c+=a;return d.push(this.getPointByLen(b)),d},getPointsByTime:function(a){a=a||.01;for(var b=0,c=[];1>b;)c.push(this.getPointByTime(b)),b+=a;return c.push(this.getPointByTime(1)),c},_getSpeedLength:function(a){var b=1-a,c=b*b,d=a*a,e=this.context.$model,f=-3*e.xStart*c+3*e.cpX1*c-6*e.cpX1*b*a+6*e.cpX2*b*a-3*e.cpX2*d+3*e.xEnd*d,g=-3*e.yEnd*c+3*e.cpY1*c-6*e.cpY1*b*a+6*e.cpY2*b*a-3*e.cpY2*d+3*e.yEnd*d;return Math.sqrt(f*f+g*g)}}),d});